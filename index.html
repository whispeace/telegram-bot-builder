<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/favicon.svg">
  <title>TGBB</title>
</head>
<body>
  <!-- Верхняя панель -->
  <header class="app-header">
    <div class="logo">
      <div class="logo-icon">
        <svg class="icon" viewBox="0 0 24 24">
          <path d="M9.78 18.65l.28-4.23 7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3 3.64 12c-.88-.25-.89-.86.2-1.3l15.97-6.16c.73-.33 1.43.18 1.15 1.3l-2.72 12.81c-.19.91-.74 1.13-1.5.71L12.6 16.3l-1.99 1.93c-.23.23-.42.42-.83.42z"></path>
        </svg>
      </div>
      <span class="logo-text">TG Bot Builder</span>
    </div>
    <div class="breadcrumb">
      <a href="#">Builder</a>
      <span class="separator">/</span>
      <span class="title">Customer Assistant</span>
    </div>
    <div class="actions">
      <button class="btn btn-secondary" id="btn-save">
        <svg class="icon" style="margin-right: 8px;" viewBox="0 0 24 24">
          <path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"></path>
        </svg>
        Сохранить
      </button>
      <button class="btn btn-primary" id="btn-publish">
        <svg class="icon" style="margin-right: 8px;" viewBox="0 0 24 24">
          <path d="M5 4v2h14V4H5zm0 10h4v6h6v-6h4l-7-7-7 7z"></path>
        </svg>
        Опубликовать
      </button>
    </div>
  </header>
  
  <!-- Основной контейнер приложения -->
  <div class="app-container">
    <!-- Левая боковая панель -->
    <div class="sidebar">
      <div class="sidebar-header">
        <h3 style="font-size: 14px; font-weight: 600;">Компоненты</h3>
        <button class="btn-icon sidebar-collapse-btn" aria-label="Свернуть панель" data-tooltip="Свернуть панель">
          <svg class="icon" viewBox="0 0 24 24">
            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path>
          </svg>
        </button>
      </div>
      
      <div class="sidebar-search">
        <svg class="search-icon" viewBox="0 0 24 24">
          <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
        </svg>
        <input type="text" placeholder="Поиск компонентов">
      </div>
      
      <div class="sidebar-content">
        <!-- Секция основных элементов -->
        <div class="sidebar-section">
          <div class="sidebar-section-header">
            <span>Основные элементы</span>
            <svg class="icon" viewBox="0 0 24 24">
              <path d="M7 10l5 5 5-5z"></path>
            </svg>
          </div>
          <div class="sidebar-section-content">
            <div class="sidebar-item" data-node-type="start" draggable="true" data-tooltip="Начальная точка потока">
              <div class="sidebar-item-icon primary">
                <svg class="icon" viewBox="0 0 24 24">
                  <path d="M8 5v14l11-7z"></path>
                </svg>
              </div>
              <span class="sidebar-item-label">Начало</span>
            </div>
            <div class="sidebar-item" data-node-type="message" draggable="true" data-tooltip="Отправка сообщения пользователю">
              <div class="sidebar-item-icon success">
                <svg class="icon" viewBox="0 0 24 24">
                  <path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"></path>
                </svg>
              </div>
              <span class="sidebar-item-label">Сообщение</span>
            </div>
            <div class="sidebar-item" data-node-type="input" draggable="true" data-tooltip="Получение ввода от пользователя">
              <div class="sidebar-item-icon warning">
                <svg class="icon" viewBox="0 0 24 24">
                  <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path>
                </svg>
              </div>
              <span class="sidebar-item-label">Ввод данных</span>
            </div>
            <div class="sidebar-item" data-node-type="logic" draggable="true" data-tooltip="Условная логика">
              <div class="sidebar-item-icon danger">
                <svg class="icon" viewBox="0 0 24 24">
                  <path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path>
                </svg>
              </div>
              <span class="sidebar-item-label">Условие</span>
            </div>
          </div>
        </div>
        
        <!-- Секция действий -->
        <div class="sidebar-section">
          <div class="sidebar-section-header">
            <span>Действия и интеграции</span>
            <svg class="icon" viewBox="0 0 24 24">
              <path d="M7 10l5 5 5-5z"></path>
            </svg>
          </div>
          <div class="sidebar-section-content">
            <div class="sidebar-item" data-node-type="api" draggable="true" data-tooltip="Запрос к внешнему API">
              <div class="sidebar-item-icon primary">
                <svg class="icon" viewBox="0 0 24 24">
                  <path d="M14 12l-2 2-2-2 2-2 2 2zm-2-6l2.12 2.12 2.5-2.5L12 1 7.38 5.62l2.5 2.5L12 6zm-6 6l2.12-2.12-2.5-2.5L1 12l4.62 4.62 2.5-2.5L6 12zm12 0l-2.12 2.12 2.5 2.5L23 12l-4.62-4.62-2.5 2.5L18 12zm-6 6l-2.12-2.12-2.5 2.5L12 23l4.62-4.62-2.5-2.5L12 18z"></path>
                </svg>
              </div>
              <span class="sidebar-item-label">API запрос</span>
            </div>
            <div class="sidebar-item" data-node-type="payment" draggable="true" data-tooltip="Обработка платежей">
              <div class="sidebar-item-icon success">
                <svg class="icon" viewBox="0 0 24 24">
                  <path d="M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4v-6h16v6zm0-10H4V6h16v2z"></path>
                </svg>
              </div>
              <span class="sidebar-item-label">Платеж</span>
            </div>
            <div class="sidebar-item" data-node-type="database" draggable="true" data-tooltip="Работа с базой данных">
              <div class="sidebar-item-icon warning">
                <svg class="icon" viewBox="0 0 24 24">
                  <path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"></path>
                </svg>
              </div>
              <span class="sidebar-item-label">База данных</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Рабочая область -->
    <div class="canvas-container">
      <div class="canvas" id="canvas">
        <!-- Пример соединения (SVG) -->
        <!-- <svg class="connection" style="position: absolute; left: 280px; top: 160px; width: 150px; height: 100px;">
          <path d="M 10 10 C 10 50, 140 50, 140 90" stroke-width="2"></path>
          <path d="M 136 82 L 140 90 L 132 86" class="connection-arrow"></path>
        </svg> -->
        
        <!-- Пример узла -->
        <!-- <div class="node" style="left: 100px; top: 100px;">
          <div class="node-header">
            <div class="title">
              <div class="indicator start"></div>
              <span>Начало диалога</span>
            </div>
            <div class="actions">
              <button class="btn-icon" aria-label="Дублировать" data-tooltip="Дублировать">
                <svg class="icon" style="width: 16px; height: 16px;" viewBox="0 0 24 24">
                  <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path>
                </svg>
              </button>
              <button class="btn-icon" aria-label="Удалить" data-tooltip="Удалить">
                <svg class="icon" style="width: 16px; height: 16px;" viewBox="0 0 24 24">
                  <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="node-content">
            <div class="node-element">
              <div class="node-element-header">
                <span>Текст</span>
                <button class="btn-icon" aria-label="Удалить элемент" data-tooltip="Удалить элемент" style="width: 20px; height: 20px;">
                  <svg class="icon" style="width: 14px; height: 14px;" viewBox="0 0 24 24">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
                  </svg>
                </button>
              </div>
              <div class="node-element-content">
                Привет! Я бот-помощник. Как я могу вам помочь?
              </div>
            </div>
            <div class="node-add-element">
              <button>+ Добавить элемент</button>
            </div>
          </div>
          <div class="node-port node-port-out"></div>
        </div> -->
        
        <!-- Пример узла сообщения -->
        <!-- <div class="node" style="left: 400px; top: 220px;">
          <div class="node-header">
            <div class="title">
              <div class="indicator message"></div>
              <span>Приветственное сообщение</span>
            </div>
            <div class="actions">
              <button class="btn-icon" aria-label="Дублировать" data-tooltip="Дублировать">
                <svg class="icon" style="width: 16px; height: 16px;" viewBox="0 0 24 24">
                  <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path>
                </svg>
              </button>
              <button class="btn-icon" aria-label="Удалить" data-tooltip="Удалить">
                <svg class="icon" style="width: 16px; height: 16px;" viewBox="0 0 24 24">
                  <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="node-content">
            <div class="node-element">
              <div class="node-element-header">
                <span>Текст</span>
                <button class="btn-icon" aria-label="Удалить элемент" data-tooltip="Удалить элемент" style="width: 20px; height: 20px;">
                  <svg class="icon" style="width: 14px; height: 14px;" viewBox="0 0 24 24">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
                  </svg>
                </button>
              </div>
              <div class="node-element-content">
                Что вас интересует?
              </div>
            </div>
            <div class="node-element">
              <div class="node-element-header">
                <span>Изображение</span>
                <button class="btn-icon" aria-label="Удалить элемент" data-tooltip="Удалить элемент" style="width: 20px; height: 20px;">
                  <svg class="icon" style="width: 14px; height: 14px;" viewBox="0 0 24 24">
                    <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
                  </svg>
                </button>
              </div>
              <div class="node-element-content">
                Демонстрационное изображение
              </div>
            </div>
            <div class="node-add-element">
              <button>+ Добавить элемент</button>
            </div>
          </div>
          <div class="node-port node-port-in"></div>
          <div class="node-port node-port-out"></div>
        </div> -->
      </div>
      

<!-- Расширенная панель инструментов -->
<div class="toolbar-container" id="toolbar-container">
  <!-- Группа инструментов редактирования -->
  <div class="toolbar-group">
    <button class="toolbar-button" id="tool-select" data-tooltip="Выбрать (V)" aria-label="Выбрать">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M7,2l12,11.2l-5.8,0.5l3.3,7.3l-2.2,1l-3.2-7.4L7,18.5V2"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-pan" data-tooltip="Перемещение холста (H)" aria-label="Перемещение холста">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-connect" data-tooltip="Создать соединение (C)" aria-label="Создать соединение">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M16 6l2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6h-6z"></path>
      </svg>
    </button>
    
    <div class="toolbar-separator"></div>
    
    <button class="toolbar-button" id="tool-align-left" data-tooltip="Выровнять по левому краю" aria-label="Выровнять по левому краю">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M4 22H2V2h2v20zM22 7H6v3h16V7zm-6 7H6v3h10v-3z"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-align-center-h" data-tooltip="Выровнять по центру" aria-label="Выровнять по центру">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M11 2h2v20h-2V2zm8.5 5H4.5v3h15V7zm-5 7h-5v3h5v-3z"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-align-right" data-tooltip="Выровнять по правому краю" aria-label="Выровнять по правому краю">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M20 2h2v20h-2V2zM2 7h16v3H2V7zm6 7h10v3H8v-3z"></path>
      </svg>
    </button>
    
    <div class="toolbar-separator"></div>
    
    <button class="toolbar-button" id="tool-distribute-h" data-tooltip="Распределить по горизонтали" aria-label="Распределить по горизонтали">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M4 22H2V2h2v20zM22 2h-2v20h2V2zM13.5 7h-3v10h3V7z"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-distribute-v" data-tooltip="Распределить по вертикали" aria-label="Распределить по вертикали">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M22 4V2H2v2h20zM2 22h20v-2H2v2zM7 10.5v3h10v-3H7z"></path>
      </svg>
    </button>
  </div>
  
  <!-- Группа масштабирования и навигации -->
  <div class="toolbar-group">
    <button class="toolbar-button" id="tool-zoom-in" data-tooltip="Увеличить (Ctrl++)" aria-label="Увеличить">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-zoom-out" data-tooltip="Уменьшить (Ctrl+-)" aria-label="Уменьшить">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M19 13H5v-2h14v2z"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-zoom-fit" data-tooltip="По размеру экрана (Ctrl+0)" aria-label="По размеру экрана">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M15 3l2.3 2.3-2.89 2.87 1.42 1.42L18.7 6.7 21 9V3h-6zM3 9l2.3-2.3 2.87 2.89 1.42-1.42L6.7 5.3 9 3H3v6zm6 12l-2.3-2.3 2.89-2.87-1.42-1.42L5.3 17.3 3 15v6h6zm12-6l-2.3 2.3-2.87-2.89-1.42 1.42 2.89 2.87L15 21h6v-6z"></path>
      </svg>
    </button>
    
    <div class="toolbar-separator"></div>
    
    <button class="toolbar-button" id="tool-undo" data-tooltip="Отменить (Ctrl+Z)" aria-label="Отменить">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-redo" data-tooltip="Повторить (Ctrl+Shift+Z)" aria-label="Повторить">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16a8.002 8.002 0 017.6-5.5c1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"></path>
      </svg>
    </button>
  </div>
  
  <!-- Группа настроек отображения -->
  <div class="toolbar-group">
    <button class="toolbar-button" id="tool-toggle-grid" data-tooltip="Показать/скрыть сетку (G)" aria-label="Показать/скрыть сетку">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 20H4v-4h4v4zm0-6H4v-4h4v4zm0-6H4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4z"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-toggle-snap" data-tooltip="Привязка к сетке (S)" aria-label="Привязка к сетке">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M17 15l1.55 1.55c-.96 1.69-3.33 3.04-5.55 3.37V11h3V9h-3V7.82C14.16 7.4 15 6.3 15 5c0-1.65-1.35-3-3-3S9 3.35 9 5c0 1.3.84 2.4 2 2.82V9H8v2h3v8.92c-2.22-.33-4.59-1.68-5.55-3.37L7 15l-4-3v3c0 3.88 4.92 7 9 7s9-3.12 9-7v-3l-4 3zM12 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-toggle-guides" data-tooltip="Показать/скрыть направляющие" aria-label="Показать/скрыть направляющие">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M3 5v4h2V5h4V3H5c-1.1 0-2 .9-2 2zm2 10H3v4c0 1.1.9 2 2 2h4v-2H5v-4zm14 4h-4v2h4c1.1 0 2-.9 2-2v-4h-2v4zm0-16h-4v2h4v4h2V5c0-1.1-.9-2-2-2z"></path>
      </svg>
    </button>
    
    <div class="toolbar-separator"></div>
    
    <button class="toolbar-button" id="tool-toggle-dark-mode" data-tooltip="Переключить тему" aria-label="Переключить тему">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"></path>
      </svg>
    </button>
    <button class="toolbar-button" id="tool-toggle-simulation" data-tooltip="Запустить симуляцию" aria-label="Запустить симуляцию">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M8 5v14l11-7z"></path>
      </svg>
    </button>
  </div>
</div>

<!-- Контекстная панель инструментов (появляется при выделении) -->
<div class="context-toolbar" id="context-toolbar"></div>

<!-- Контекстное меню для узлов -->
<div class="node-contextmenu" id="node-contextmenu">
  <div class="contextmenu-item" id="contextmenu-copy">
    <svg class="icon" viewBox="0 0 24 24">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path>
    </svg>
    Копировать
  </div>
  <div class="contextmenu-item" id="contextmenu-duplicate">
    <svg class="icon" viewBox="0 0 24 24">
      <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm-1 4l6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2h7zm-1 7h5.5L14 6.5V12z"></path>
    </svg>
    Дублировать
  </div>
  <div class="contextmenu-item" id="contextmenu-rename">
    <svg class="icon" viewBox="0 0 24 24">
      <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path>
    </svg>
    Переименовать
  </div>
  <div class="contextmenu-separator"></div>
  <div class="contextmenu-item danger" id="contextmenu-delete">
    <svg class="icon" viewBox="0 0 24 24">
      <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path>
    </svg>
    Удалить
  </div>
</div>

<!-- Кнопка для мобильного меню -->
<button class="mobile-sidebar-toggle" id="mobile-sidebar-toggle" aria-label="Показать меню">
  <svg class="icon" viewBox="0 0 24 24">
    <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path>
  </svg>
</button>
    </div>
    
    <!-- Панель свойств -->
    <div class="properties-panel visible" id="properties-panel">
      <div class="properties-panel-header">
        <div class="properties-title">
          <div class="properties-icon">
            <svg class="icon" viewBox="0 0 24 24" style="color: var(--accent-primary);">
              <path d="M8 5v14l11-7z"></path>
            </svg>
          </div>
          <span>Начало диалога</span>
        </div>
        <button class="btn-icon" id="close-properties" aria-label="Закрыть панель свойств">
          <svg class="icon" viewBox="0 0 24 24">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
          </svg>
        </button>
      </div>
      
      <div class="properties-panel-body">
        <div class="properties-preview">
          <div style="text-align: center; color: var(--text-secondary);">
            <svg class="icon" viewBox="0 0 24 24" style="width: 36px; height: 36px; margin-bottom: 12px; color: var(--accent-primary);">
              <path d="M8 5v14l11-7z"></path>
            </svg>
            <div>Начальный узел потока</div>
          </div>
        </div>
        
        <div class="properties-form">
          <div class="properties-section">
            <h3 class="properties-section-title">Общие настройки</h3>
            <div class="form-group">
              <label for="node-name">Название</label>
              <input type="text" id="node-name" class="form-control" value="Начало диалога">
            </div>
            <div class="form-group">
              <label for="node-description">Описание</label>
              <textarea id="node-description" class="form-control" placeholder="Описание компонента...">Начальная точка диалога. Отсюда начинается взаимодействие бота с пользователем.</textarea>
            </div>
          </div>
          
          <div class="properties-section">
            <h3 class="properties-section-title">Контент</h3>
            <div class="form-group">
              <label for="element-text">Текст сообщения</label>
              <textarea id="element-text" class="form-control">Привет! Я бот-помощник. Как я могу вам помочь?</textarea>
            </div>
            <div class="form-group d-flex justify-content-between">
              <label>Форматирование</label>
              <div>
                <button class="btn-icon" aria-label="Жирный" data-tooltip="Жирный текст">
                  <svg class="icon" style="width: 16px; height: 16px;" viewBox="0 0 24 24">
                    <path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"></path>
                  </svg>
                </button>
                <button class="btn-icon" aria-label="Курсив" data-tooltip="Курсив">
                  <svg class="icon" style="width: 16px; height: 16px;" viewBox="0 0 24 24">
                    <path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"></path>
                  </svg>
                </button>
                <button class="btn-icon" aria-label="Ссылка" data-tooltip="Вставить ссылку">
                  <svg class="icon" style="width: 16px; height: 16px;" viewBox="0 0 24 24">
                    <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="properties-panel-footer">
        <button class="btn btn-secondary" id="duplicate-element">Дублировать</button>
        <button class="btn btn-danger" id="delete-element">Удалить</button>
      </div>
    </div>
  </div>
  
  <!-- Мини-карта -->
<div class="minimap-container" id="minimap-container">
  <div class="minimap-header">
    <div class="minimap-title">Мини-карта</div>
    <button class="btn-icon" id="minimap-close" aria-label="Закрыть мини-карту" data-tooltip="Закрыть мини-карту">
      <svg class="icon" style="width: 14px; height: 14px;" viewBox="0 0 24 24">
        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
      </svg>
    </button>
  </div>
  <div class="minimap-content" id="minimap-content">
    <div class="minimap-canvas" id="minimap-canvas"></div>
    <div class="minimap-viewport" id="minimap-viewport"></div>
  </div>
</div>

<button class="minimap-toggle" id="minimap-toggle" aria-label="Показать мини-карту" data-tooltip="Показать мини-карту">
  <svg class="icon" style="width: 20px; height: 20px;" viewBox="0 0 24 24">
    <path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"></path>
  </svg>
</button>
  
  <!-- Тултип (пример) -->
  <div class="tooltip" style="left: 500px; top: 100px; display: none;">
    Перетащите элемент на холст, чтобы создать новый узел
  </div>
  
  <!-- Контекстное меню (пример) -->
  <div class="context-menu" style="left: 300px; top: 200px; display: none;">
    <div class="context-menu-item">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"></path>
      </svg>
      Дублировать
    </div>
    <div class="context-menu-item">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path>
      </svg>
      Переименовать
    </div>
    <div class="context-menu-divider"></div>
    <div class="context-menu-item">
      <svg class="icon" viewBox="0 0 24 24">
        <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path>
      </svg>
      Удалить
    </div>
  </div>
  <script type="module" src="/src/main.js"></script>
</body>
</html>